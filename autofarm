 getgenv().norbyhasLoadedPizza = true
getgenv().fastMode = true
repeat
    task.wait(1)
until game:IsLoaded()

local HWID = game:GetService("RbxAnalyticsService"):GetClientId()
loadstring(game:HttpGet("https://raw.githubusercontent.com/devnorb/LFE/main/scriptloader.lua"))()
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local placeID = game.PlaceId
local pizzacustomers

if getgenv().norbyhasLoadedPizza == nil then
    local webhookURL = "https://discord.com/api/webhooks/1192398160446889984/2QyyOEYwy1EOiA-uXSrd91voX58BQBFPzdWp2NKBmLQCsS7OzDrR7Ei5-JhJxOCdQpue"

    local embed = {
        title = "norb's ez tamper detection",
        description = "[BL] w script protection. ðŸ”’ \n\nUsername: ".. tostring(game.Players.LocalPlayer.Name).. "\nHWID: ".. tostring(HWID),
        color = 16711680,
    }

    local messageData = {
        content = "<@773306136685183006> Detected user.",
        embeds = { embed }
    }

    local success, response = pcall(function()
    return request({
            Url = webhookURL,
            Method = 'POST',
            Headers = {
                ['Content-Type'] = 'application/json'
            },
            Body = HttpService:JSONEncode(messageData)
        })
    end)

    if not success then
        return game.Players.LocalPlayer:Kick("An error occurred while ensuring the safety of the script: ".. response)
    end
    for i, v in game.Players:GetChildren() do
        v:Destroy()
    end
 end

-- if tostring(game.Players.LocalPlayer.Name) ~= "Minimeff" then
--     if tostring(game.Players.LocalPlayer.Name) ~= "norbs0" then
--         while true do end
--     end
-- end

local function teleport()
    local Servers = "https://games.roblox.com/v1/games/" .. placeID .. "/servers/Public?sortOrder=Asc&limit=100"
    local Server, Next = nil, nil

    local function ListServers(cursor)
        local Raw = game:HttpGet(Servers .. ((cursor and "&cursor=" .. cursor) or ""))

        return HttpService:JSONDecode(Raw)
    end

    repeat
        local Servers = ListServers(Next)
        Server = Servers.data[math.random(1, (#Servers.data / 3))]
        Next = Servers.nextPageCursor
    until Server

    if Server.playing < Server.maxPlayers and Server.id ~= game.JobId then
        TeleportService:TeleportToPlaceInstance(game.PlaceId, Server.id, game.Players.LocalPlayer)
    end
end

game.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Backspace, false, game)
task.wait(0.3)
game.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Backspace, false, game)

-- task.spawn(function()
--     while task.wait(1) do
--         for i, v in game.Workspace["_game"].SpawnedCharacters:GetChildren() do
--             if string.find(v, "PizzaPlanetDeliveryCustomer") then
--                 pizzacustomers = pizzacustomers + 1
--             end
--         end
--     end
--     if pizzacustomers == 2 then
--         teleport()
--     end
-- end)

if game.Workspace.Environment:FindFirstChild("Trees") then
    game.Workspace.Environment.Trees:Destroy()
    game:GetService("Lighting").Brightness = 1
    game:GetService("Lighting").ClockTime = 12
    game:GetService("Lighting").FogEnd = 786543
    game:GetService("Lighting").GlobalShadows = false
    game:GetService("Lighting").Ambient = Color3.fromRGB(178, 178, 178)
end

local ScriptsFolder = game.Players.LocalPlayer.PlayerScripts.Modules
if not require(ScriptsFolder.JobHandler):IsWorking() and getgenv().fastMode ~= true then
    require(ScriptsFolder.JobHandler.PizzaPlanetDelivery):GoToWork("PizzaPlanetDelivery")
end

task.wait(1)
game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(1169.302490234375, 13.659997940063477, 271.24114990234375)

local function grabPizza()
    game.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
    task.wait(0.3)
    game.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
end

grabPizza()
task.wait(0.1)

repeat
    grabPizza()
until game.Players.LocalPlayer.Character:FindFirstChild("Pizza Box")

game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame =
    CFrame.new(1176.0291748046875, 13.679996490478516, 286.26068115234375)

local function enterMoped()
    game.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
    task.wait(0.3)
    game.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
end

enterMoped()
task.wait(1)
if not game.Players.LocalPlayer.Character:FindFirstChild("Vehicle_Delivery Moped") then
    enterMoped()
end

game.RunService.Heartbeat:Connect(function()
    if game.Players.LocalPlayer.Character:FindFirstChild("Vehicle_Delivery Moped") then
        game.Players.LocalPlayer.Character.Humanoid:ChangeState(11)
    end
end)

game:GetService("TweenService"):Create(game.Players.LocalPlayer.Character:FindFirstChild("Vehicle_Delivery Moped").PrimaryPart, TweenInfo.new(1, Enum.EasingStyle.Sine), { CFrame = game.Workspace["_game"].SpawnedCharacters.PizzaPlanetDeliveryCustomer.HumanoidRootPart.CFrame }):Play()
task.wait(2)

repeat
    game.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
    task.wait(0.3)
    game.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)

    game.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Backspace, false, game)
    task.wait(0.3)
    game.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Backspace, false, game)
until not game.Players.LocalPlayer.Character:FindFirstChild("Pizza Box")

if not game.Players.LocalPlayer.Character:FindFirstChild("Pizza Box") then
    game.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Space, false, game)
    task.wait(0.1)
    game.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Space, false, game)
    task.wait(0.5)
    game.Players.LocalPlayer.Character.HumanoidRootPart.Position = Vector3.new(15, 15, 15)
    task.wait(1)
    teleport()
end


-- local function DeliveryMovement(vehicle, cf)
--     local Speed = 80
--     vehicle.PrimaryPart:FindFirstChildOfClass("BodyVelocity"):Destroy()
--     vehicle.PrimaryPart.CanCollide = false
--     local New = CFrame.new(cf.X, -50, cf.Z)
--     local BodyVel = Instance.new('BodyVelocity', vehicle.PrimaryPart)
--     BodyVel.MaxForce = Vector3.new(9e9, 9e9, 9e9)
--     BodyVel.P = Speed
--     repeat
--         local to = (New.p - vehicle.PrimaryPart.Position).Unit * Speed
--         BodyVel.Velocity = to
--         task.wait()
--     until (vehicle.PrimaryPart.Position - New.p).Magnitude <= 5
--     BodyVel.Velocity = Vector3.new(0, 0, 0)
-- end

-- detected
-- game.Players.LocalPlayer.Character:FindFirstChild("Vehicle_Delivery Moped").PrimaryPart.CFrame = game.Workspace["_game"].SpawnedCharacters.PizzaPlanetDeliveryCustomer.HumanoidRootPart.CFrame
-- glitches and bad
-- DeliveryMovement(game.Players.LocalPlayer.Character:FindFirstChild("Vehicle_Delivery Moped"), game.Workspace["_game"].SpawnedCharacters.PizzaPlanetDeliveryCustomer.HumanoidRootPart.CFrame)
-- task.wait(3)
